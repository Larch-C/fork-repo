name: Fork / Sync All AstrBot Plugins

on:
  workflow_dispatch:          # æ‰‹åŠ¨è§¦å‘
    inputs:
      dry_run:
        description: 'è¯•è¿è¡Œæ¨¡å¼ï¼ˆä»…æ˜¾ç¤ºæ“ä½œï¼Œä¸å®žé™…æ‰§è¡Œï¼‰'
        required: false
        default: false
        type: boolean
      force_sync:
        description: 'å¼ºåˆ¶åŒæ­¥æ‰€æœ‰å·²forkçš„ä»“åº“'
        required: false
        default: false
        type: boolean
  schedule:                   # æ¯å‘¨æ—¥ 03:00 UTC è‡ªåŠ¨åŒæ­¥
    - cron: "0 3 * * 0"

env:
  PLUGIN_JSON_URL: "https://raw.githubusercontent.com/AstrBotDevs/AstrBot_Plugins_Collection/main/plugins.json"

jobs:
  prepare:
    runs-on: ubuntu-latest
    outputs:
      repos: ${{ steps.list.outputs.repos }}
      total_count: ${{ steps.list.outputs.total_count }}
    steps:
      - name: Fetch plugins.json
        run: |
          echo "ðŸ“¥ æ­£åœ¨èŽ·å– plugins.json..."
          curl -fsSL "$PLUGIN_JSON_URL" -o plugins.json
          echo "âœ… plugins.json èŽ·å–å®Œæˆ"
          
      - name: Parse repo list
        id: list
        run: |
          echo "ðŸ“‹ æ­£åœ¨è§£æžä»“åº“åˆ—è¡¨..."
          
          # æå–æ‰€æœ‰ä»“åº“URLå¹¶æ¸…ç†æ ¼å¼
          repos=$(jq -r '
            to_entries[] | 
            select(.value.repo != null) | 
            .value.repo
          ' plugins.json | \
          sed 's|git@github.com:|https://github.com/|' | \
          sed 's|\.git$||' | \
          sed 's|/tree/.*||' | \
          sed 's|/blob/.*||' | \
          grep -E '^https://github\.com/[^/]+/[^/]+$' | \
          sort -u)
          
          # è½¬æ¢ä¸ºJSONæ•°ç»„æ ¼å¼
          repo_array=$(echo "$repos" | jq -R -s -c 'split("\n") | map(select(. != ""))')
          total_count=$(echo "$repos" | wc -l)
          
          echo "repos=$repo_array" >> $GITHUB_OUTPUT
          echo "total_count=$total_count" >> $GITHUB_OUTPUT
          
          echo "ðŸ“Š æ‰¾åˆ° $total_count ä¸ªæœ‰æ•ˆçš„GitHubä»“åº“ï¼š"
          echo "$repos" | head -10
          if [ $total_count -gt 10 ]; then
            echo "... å’Œå…¶ä»– $((total_count - 10)) ä¸ªä»“åº“"
          fi

  fork-sync:
    runs-on: ubuntu-latest
    needs: prepare
    if: needs.prepare.outputs.total_count > 0
    outputs:
      results: ${{ steps.collect_results.outputs.results }}
    strategy:
      max-parallel: 5           # é™ä½Žå¹¶å‘æ•°ä»¥é¿å…rate limit
      fail-fast: false         # æŸä¸ªä»“åº“å¤±è´¥ä¸å½±å“å…¶ä»–ä»“åº“
      matrix:
        repo: ${{ fromJson(needs.prepare.outputs.repos) }}

    steps:
      - name: Setup environment
        run: |
          # è®¡ç®—å½“å‰jobåœ¨çŸ©é˜µä¸­çš„ä½ç½®ç”¨äºŽåˆ†ç»„å»¶è¿Ÿ
          echo "REPO_URL=${{ matrix.repo }}" >> $GITHUB_ENV
          echo "JOB_INDEX=${{ strategy.job-index }}" >> $GITHUB_ENV
          echo "TOTAL_JOBS=${{ strategy.job-total }}" >> $GITHUB_ENV
          
      - name: Setup GH CLI
        run: |
          echo "${{ secrets.GITHUB_TOKEN }}" | gh auth login --with-token
          
      - name: Group delay (Rate limiting protection)
        if: ${{ strategy.job-index != 0 }}
        run: |
          # æ£€æŸ¥æ˜¯å¦éœ€è¦å»¶è¿Ÿï¼ˆæ¯5ä¸ªä»»åŠ¡å»¶è¿Ÿä¸€æ¬¡ï¼‰
          if [ $((${JOB_INDEX} % 5)) -eq 0 ]; then
            echo "â±ï¸  ç¬¬ ${{ strategy.job-index }} ä¸ªä»»åŠ¡ï¼Œç­‰å¾…30ç§’é˜²æ­¢rate limit..."
            sleep 30
          fi
          
      - name: Extract repo info
        id: repo_info
        run: |
          repo_url="${{ matrix.repo }}"
          owner_repo=${repo_url#*github.com/}
          owner_repo=${owner_repo%/}
          owner=$(echo "$owner_repo" | cut -d/ -f1)
          repo=$(echo "$owner_repo" | cut -d/ -f2)
          
          echo "owner_repo=$owner_repo" >> $GITHUB_OUTPUT
          echo "owner=$owner" >> $GITHUB_OUTPUT
          echo "repo=$repo" >> $GITHUB_OUTPUT
          
          echo "ðŸ“¦ å¤„ç†ä»“åº“: $owner_repo"
          
      - name: Check if repo exists
        id: check_repo
        run: |
          if gh repo view "${{ steps.repo_info.outputs.owner_repo }}" --json name >/dev/null 2>&1; then
            echo "repo_exists=true" >> $GITHUB_OUTPUT
            echo "âœ… ä»“åº“å­˜åœ¨: ${{ steps.repo_info.outputs.owner_repo }}"
          else
            echo "repo_exists=false" >> $GITHUB_OUTPUT
            echo "âŒ ä»“åº“ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®: ${{ steps.repo_info.outputs.owner_repo }}"
          fi
          
      - name: Check fork status
        id: check_fork
        if: steps.check_repo.outputs.repo_exists == 'true'
        run: |
          my_login=$(gh api user --jq .login)
          my_fork="${my_login}/${{ steps.repo_info.outputs.repo }}"
          
          if gh repo view "$my_fork" --json name,parent >/dev/null 2>&1; then
            # æ£€æŸ¥æ˜¯å¦æ˜¯æ­£ç¡®çš„fork
            parent_name=$(gh repo view "$my_fork" --json parent --jq '.parent.nameWithOwner // empty')
            if [ "$parent_name" = "${{ steps.repo_info.outputs.owner_repo }}" ]; then
              echo "fork_exists=true" >> $GITHUB_OUTPUT
              echo "ðŸ”„ å·²fork: $my_fork <- ${{ steps.repo_info.outputs.owner_repo }}"
            else
              echo "fork_exists=false" >> $GITHUB_OUTPUT
              echo "âš ï¸  ä»“åº“ $my_fork å­˜åœ¨ä½†ä¸æ˜¯æ­£ç¡®çš„fork"
            fi
          else
            echo "fork_exists=false" >> $GITHUB_OUTPUT
            echo "ðŸ†• å°šæœªfork: ${{ steps.repo_info.outputs.owner_repo }}"
          fi
          
      - name: Fork repository
        if: |
          steps.check_repo.outputs.repo_exists == 'true' && 
          steps.check_fork.outputs.fork_exists == 'false' &&
          !inputs.dry_run
        run: |
          echo "ðŸ´ æ­£åœ¨fork: ${{ steps.repo_info.outputs.owner_repo }}"
          
          if gh repo fork "${{ steps.repo_info.outputs.owner_repo }}" --clone=false; then
            echo "âœ… ForkæˆåŠŸ: ${{ steps.repo_info.outputs.owner_repo }}"
            echo "FORK_RESULT=success" >> $GITHUB_ENV
          else
            echo "âŒ Forkå¤±è´¥: ${{ steps.repo_info.outputs.owner_repo }}"
            echo "FORK_RESULT=failed" >> $GITHUB_ENV
            exit 1
          fi
          
      - name: Sync fork
        if: |
          steps.check_repo.outputs.repo_exists == 'true' && 
          steps.check_fork.outputs.fork_exists == 'true' &&
          (inputs.force_sync || github.event_name == 'schedule') &&
          !inputs.dry_run
        run: |
          my_login=$(gh api user --jq .login)
          my_fork="${my_login}/${{ steps.repo_info.outputs.repo }}"
          
          echo "ðŸ”„ æ­£åœ¨åŒæ­¥fork: $my_fork"
          
          # ä½¿ç”¨GitHub CLIçš„syncå‘½ä»¤ï¼ˆæ›´å®‰å…¨ç®€å•ï¼‰
          if gh repo sync "$my_fork" --source "${{ steps.repo_info.outputs.owner_repo }}"; then
            echo "âœ… åŒæ­¥æˆåŠŸ: $my_fork"
            echo "SYNC_RESULT=success" >> $GITHUB_ENV
          else
            echo "âš ï¸  åŒæ­¥å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ²¡æœ‰æ–°çš„æ›´æ–°: $my_fork"
            echo "SYNC_RESULT=no_changes" >> $GITHUB_ENV
            # ä¸é€€å‡ºï¼Œå› ä¸ºå¯èƒ½åªæ˜¯æ²¡æœ‰æ›´æ–°
          fi
          
      - name: Set result status
        if: always()
        run: |
          # ç¡®å®šæœ€ç»ˆçŠ¶æ€
          if [ "${{ steps.check_repo.outputs.repo_exists }}" = "false" ]; then
            echo "FINAL_STATUS=not_found" >> $GITHUB_ENV
            echo "STATUS_MESSAGE=ä»“åº“ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®" >> $GITHUB_ENV
          elif [ "${{ inputs.dry_run }}" = "true" ]; then
            if [ "${{ steps.check_fork.outputs.fork_exists }}" = "false" ]; then
              echo "FINAL_STATUS=will_fork" >> $GITHUB_ENV
              echo "STATUS_MESSAGE=å°†ä¼šfork" >> $GITHUB_ENV
            else
              echo "FINAL_STATUS=will_sync" >> $GITHUB_ENV
              echo "STATUS_MESSAGE=å·²forkï¼Œéœ€è¦æ—¶ä¼šåŒæ­¥" >> $GITHUB_ENV
            fi
          elif [ "${{ steps.check_fork.outputs.fork_exists }}" = "false" ]; then
            # éœ€è¦forkçš„æƒ…å†µ
            if [ "$FORK_RESULT" = "success" ]; then
              echo "FINAL_STATUS=forked" >> $GITHUB_ENV
              echo "STATUS_MESSAGE=æ–°forkæˆåŠŸ" >> $GITHUB_ENV
            else
              echo "FINAL_STATUS=fork_failed" >> $GITHUB_ENV
              echo "STATUS_MESSAGE=forkå¤±è´¥" >> $GITHUB_ENV
            fi
          else
            # å·²ç»forkï¼Œå¯èƒ½éœ€è¦åŒæ­¥
            if [ "${{ inputs.force_sync }}" = "true" ] || [ "${{ github.event_name }}" = "schedule" ]; then
              if [ "$SYNC_RESULT" = "success" ]; then
                echo "FINAL_STATUS=synced" >> $GITHUB_ENV
                echo "STATUS_MESSAGE=åŒæ­¥æˆåŠŸ" >> $GITHUB_ENV
              elif [ "$SYNC_RESULT" = "no_changes" ]; then
                echo "FINAL_STATUS=up_to_date" >> $GITHUB_ENV
                echo "STATUS_MESSAGE=å·²æ˜¯æœ€æ–°" >> $GITHUB_ENV
              else
                echo "FINAL_STATUS=sync_failed" >> $GITHUB_ENV
                echo "STATUS_MESSAGE=åŒæ­¥å¤±è´¥" >> $GITHUB_ENV
              fi
            else
              echo "FINAL_STATUS=already_forked" >> $GITHUB_ENV
              echo "STATUS_MESSAGE=å·²forkï¼ˆæœªåŒæ­¥ï¼‰" >> $GITHUB_ENV
            fi
          fi
          
      - name: Save result
        if: always()
        run: |
          my_login=$(gh api user --jq .login 2>/dev/null || echo "unknown")
          
          # åˆ›å»ºç»“æžœJSON
          result_json=$(jq -n \
            --arg repo "${{ steps.repo_info.outputs.owner_repo }}" \
            --arg owner "${{ steps.repo_info.outputs.owner }}" \
            --arg repo_name "${{ steps.repo_info.outputs.repo }}" \
            --arg status "$FINAL_STATUS" \
            --arg message "$STATUS_MESSAGE" \
            --arg my_fork "${my_login}/${{ steps.repo_info.outputs.repo }}" \
            --arg timestamp "$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
            '{
              repo: $repo,
              owner: $owner,
              repo_name: $repo_name,
              status: $status,
              message: $message,
              my_fork: $my_fork,
              timestamp: $timestamp
            }')
          
          echo "RESULT_JSON=$result_json" >> $GITHUB_ENV
          
          # ä¿å­˜åˆ°æ–‡ä»¶
          mkdir -p results
          echo "$result_json" > "results/${{ steps.repo_info.outputs.owner }}_${{ steps.repo_info.outputs.repo }}.json"
          
      - name: Upload result artifact
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: result-${{ steps.repo_info.outputs.owner }}-${{ steps.repo_info.outputs.repo }}
          path: results/
          retention-days: 7

      - name: Dry run summary
        if: inputs.dry_run
        run: |
          echo "ðŸ” [DRY RUN] ä»“åº“: ${{ steps.repo_info.outputs.owner_repo }}"
          if [ "${{ steps.check_repo.outputs.repo_exists }}" = "false" ]; then
            echo "  âŒ ä»“åº“ä¸å­˜åœ¨ï¼Œè·³è¿‡"
          elif [ "${{ steps.check_fork.outputs.fork_exists }}" = "false" ]; then
            echo "  ðŸ´ å°†ä¼šforkæ­¤ä»“åº“"
          else
            echo "  ðŸ”„ å·²forkï¼Œéœ€è¦æ—¶ä¼šåŒæ­¥"
          fi

  collect-results:
    runs-on: ubuntu-latest
    needs: [prepare, fork-sync]
    if: always() && needs.prepare.outputs.total_count > 0
    steps:
      - name: Download all results
        uses: actions/download-artifact@v4
        with:
          pattern: result-*
          path: all-results/
          merge-multiple: true

      - name: Generate results table
        run: |
          echo "ðŸ“Š æ­£åœ¨ç”Ÿæˆç»“æžœè¡¨æ ¼..."
          
          # åˆ›å»ºç»“æžœæ±‡æ€»
          echo "# ðŸŽ¯ AstrBotæ’ä»¶Fork/Syncç»“æžœæŠ¥å‘Š" > results_summary.md
          echo "" >> results_summary.md
          echo "**æ“ä½œæ—¶é—´:** $(date -u '+%Y-%m-%d %H:%M:%S UTC')" >> results_summary.md
          echo "**æ“ä½œæ¨¡å¼:** ${{ inputs.dry_run && 'ðŸ” è¯•è¿è¡Œ' || 'â–¶ï¸ å®žé™…æ‰§è¡Œ' }}" >> results_summary.md
          echo "**æ€»ä»“åº“æ•°:** ${{ needs.prepare.outputs.total_count }}" >> results_summary.md
          echo "" >> results_summary.md
          
          # ç»Ÿè®¡å„ç§çŠ¶æ€
          total=0
          forked=0
          synced=0
          up_to_date=0
          already_forked=0
          failed=0
          not_found=0
          
          # åˆ›å»ºè¡¨æ ¼å¤´
          echo "## ðŸ“‹ è¯¦ç»†ç»“æžœ" >> results_summary.md
          echo "" >> results_summary.md
          echo "| ä»“åº“ | çŠ¶æ€ | æˆ‘çš„Fork | è¯´æ˜Ž | æ—¶é—´ |" >> results_summary.md
          echo "|------|------|----------|------|------|" >> results_summary.md
          
          # å¤„ç†æ‰€æœ‰ç»“æžœæ–‡ä»¶
          if [ -d "all-results" ]; then
            for file in all-results/*.json; do
              if [ -f "$file" ]; then
                total=$((total + 1))
                
                # æå–æ•°æ®
                repo=$(jq -r '.repo' "$file")
                status=$(jq -r '.status' "$file")
                message=$(jq -r '.message' "$file")
                my_fork=$(jq -r '.my_fork' "$file")
                timestamp=$(jq -r '.timestamp' "$file")
                
                # æ ¼å¼åŒ–æ—¶é—´
                formatted_time=$(date -d "$timestamp" '+%H:%M' 2>/dev/null || echo "N/A")
                
                # çŠ¶æ€å›¾æ ‡å’Œç»Ÿè®¡
                case "$status" in
                  "forked")
                    icon="ðŸ´"
                    forked=$((forked + 1))
                    ;;
                  "synced")
                    icon="ðŸ”„"
                    synced=$((synced + 1))
                    ;;
                  "up_to_date")
                    icon="âœ…"
                    up_to_date=$((up_to_date + 1))
                    ;;
                  "already_forked")
                    icon="ðŸ“"
                    already_forked=$((already_forked + 1))
                    ;;
                  "fork_failed"|"sync_failed")
                    icon="âŒ"
                    failed=$((failed + 1))
                    ;;
                  "not_found")
                    icon="ðŸš«"
                    not_found=$((not_found + 1))
                    ;;
                  "will_fork")
                    icon="ðŸ”®"
                    ;;
                  "will_sync")
                    icon="ðŸ”®"
                    ;;
                  *)
                    icon="â“"
                    ;;
                esac
                
                # æ·»åŠ åˆ°è¡¨æ ¼
                echo "| [\`$repo\`](https://github.com/$repo) | $icon $message | [\`$my_fork\`](https://github.com/$my_fork) | $message | $formatted_time |" >> results_summary.md
              fi
            done
          fi
          
          # æ·»åŠ ç»Ÿè®¡æ‘˜è¦
          echo "" >> results_summary.md
          echo "## ðŸ“Š ç»Ÿè®¡æ‘˜è¦" >> results_summary.md
          echo "" >> results_summary.md
          echo "| çŠ¶æ€ | æ•°é‡ | ç™¾åˆ†æ¯” |" >> results_summary.md
          echo "|------|------|--------|" >> results_summary.md
          
          if [ $total -gt 0 ]; then
            [ $forked -gt 0 ] && echo "| ðŸ´ æ–°forkæˆåŠŸ | $forked | $(( forked * 100 / total ))% |" >> results_summary.md
            [ $synced -gt 0 ] && echo "| ðŸ”„ åŒæ­¥æˆåŠŸ | $synced | $(( synced * 100 / total ))% |" >> results_summary.md
            [ $up_to_date -gt 0 ] && echo "| âœ… å·²æ˜¯æœ€æ–° | $up_to_date | $(( up_to_date * 100 / total ))% |" >> results_summary.md
            [ $already_forked -gt 0 ] && echo "| ðŸ“ å·²fork(æœªåŒæ­¥) | $already_forked | $(( already_forked * 100 / total ))% |" >> results_summary.md
            [ $failed -gt 0 ] && echo "| âŒ å¤±è´¥ | $failed | $(( failed * 100 / total ))% |" >> results_summary.md
            [ $not_found -gt 0 ] && echo "| ðŸš« ä»“åº“ä¸å­˜åœ¨ | $not_found | $(( not_found * 100 / total ))% |" >> results_summary.md
          fi
          
          echo "" >> results_summary.md
          echo "**æ€»è®¡:** $total ä¸ªä»“åº“" >> results_summary.md
          
          # æ·»åŠ å»ºè®®
          echo "" >> results_summary.md
          echo "## ðŸ’¡ å»ºè®®" >> results_summary.md
          echo "" >> results_summary.md
          if [ $failed -gt 0 ]; then
            echo "- âš ï¸  æœ‰ $failed ä¸ªä»“åº“æ“ä½œå¤±è´¥ï¼Œå»ºè®®æ£€æŸ¥æƒé™æˆ–ç½‘ç»œé—®é¢˜" >> results_summary.md
          fi
          if [ $not_found -gt 0 ]; then
            echo "- ðŸ” æœ‰ $not_found ä¸ªä»“åº“ä¸å­˜åœ¨ï¼Œå¯èƒ½å·²è¢«åˆ é™¤æˆ–ç§»åŠ¨" >> results_summary.md
          fi
          if [ $already_forked -gt 0 ]; then
            echo "- ðŸ”„ æœ‰ $already_forked ä¸ªå·²forkä»“åº“æœªåŒæ­¥ï¼Œå¯ä½¿ç”¨'å¼ºåˆ¶åŒæ­¥'é€‰é¡¹æ›´æ–°" >> results_summary.md
          fi
          echo "- ðŸ“… å»ºè®®å¯ç”¨å®šæœŸåŒæ­¥ä¿æŒforkæœ€æ–°" >> results_summary.md
          
          echo "âœ… ç»“æžœè¡¨æ ¼ç”Ÿæˆå®Œæˆ"
          
      - name: Upload results summary
        uses: actions/upload-artifact@v4
        with:
          name: fork-sync-results
          path: results_summary.md
          retention-days: 30

      - name: Display results in step summary
        run: |
          echo "ðŸ“Š æ­£åœ¨æ·»åŠ ç»“æžœåˆ°æ­¥éª¤æ‘˜è¦..."
          cat results_summary.md >> $GITHUB_STEP_SUMMARY

  summary:
    runs-on: ubuntu-latest
    needs: [prepare, fork-sync, collect-results]
    if: always()
    steps:
      - name: Final summary
        run: |
          echo "# ðŸŽ¯ AstrBotæ’ä»¶Fork/Syncæ“ä½œå®Œæˆ" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸ“Š **åŸºæœ¬ä¿¡æ¯:**" >> $GITHUB_STEP_SUMMARY
          echo "- æ€»ä»“åº“æ•°: ${{ needs.prepare.outputs.total_count }}" >> $GITHUB_STEP_SUMMARY
          echo "- æ“ä½œæ¨¡å¼: ${{ inputs.dry_run && 'ðŸ” è¯•è¿è¡Œ' || 'â–¶ï¸ å®žé™…æ‰§è¡Œ' }}" >> $GITHUB_STEP_SUMMARY
          echo "- å¼ºåˆ¶åŒæ­¥: ${{ inputs.force_sync && 'âœ… æ˜¯' || 'âŒ å¦' }}" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          if [ "${{ needs.collect-results.result }}" = "success" ]; then
            echo "âœ… **è¯¦ç»†ç»“æžœè¡¨æ ¼å·²ç”Ÿæˆï¼**" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "ðŸ“‹ è¯·æŸ¥çœ‹ä¸Šæ–¹çš„ \`collect-results\` æ­¥éª¤èŽ·å–å®Œæ•´çš„ç»“æžœè¡¨æ ¼ã€‚" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "ðŸ’¾ **ç»“æžœæ–‡ä»¶:**" >> $GITHUB_STEP_SUMMARY
            echo "- å¯åœ¨ Artifacts ä¸­ä¸‹è½½ \`fork-sync-results\` æ–‡ä»¶æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š" >> $GITHUB_STEP_SUMMARY
            echo "- åŒ…å«æ‰€æœ‰ä»“åº“çš„forkçŠ¶æ€ã€é“¾æŽ¥å’Œæ—¶é—´æˆ³" >> $GITHUB_STEP_SUMMARY
          else
            echo "âš ï¸  **ç»“æžœæ”¶é›†å¤±è´¥**" >> $GITHUB_STEP_SUMMARY
            echo "- æ“ä½œçŠ¶æ€: ${{ needs.fork-sync.result }}" >> $GITHUB_STEP_SUMMARY
            echo "- ç»“æžœæ”¶é›†: ${{ needs.collect-results.result }}" >> $GITHUB_STEP_SUMMARY
          fi
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸ”„ **ä¸‹æ¬¡è¿è¡Œå»ºè®®:**" >> $GITHUB_STEP_SUMMARY
          echo "- ä½¿ç”¨è¯•è¿è¡Œæ¨¡å¼é¢„è§ˆæ“ä½œ" >> $GITHUB_STEP_SUMMARY
          echo "- å®šæœŸè¿è¡Œä»¥ä¿æŒforkåŒæ­¥" >> $GITHUB_STEP_SUMMARY
          echo "- æ£€æŸ¥å¤±è´¥çš„ä»“åº“å¹¶æ‰‹åŠ¨å¤„ç†" >> $GITHUB_STEP_SUMMARY